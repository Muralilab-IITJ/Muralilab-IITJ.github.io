<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team | Murali Lab | IIT Jodhpur</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header>
    <div class="header-container">
        <div class="logo-section">
            <h1><a href="index.html" style="text-decoration: none; color: inherit;">Murali Lab</a></h1>
            <p>IIT Jodhpur</p>
        </div>
        
        <div class="menu-toggle" id="mobile-menu">
            <i class="fas fa-bars"></i>
        </div>

        <nav>
            <ul class="nav-links">
                <li><a href="research.html">Research</a></li>
                <li><a href="publications.html">Publications</a></li>
                <li><a href="team.html">Team</a></li>
                <li><a href="teaching.html">Teaching</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </nav>
    </div>
</header>
    
    <main>
        <h2 class="page-title">Our Team</h2>
        
        <div class="team-categories">
            <button class="category-btn active" data-category="all">All Members</button>
            <button class="category-btn" data-category="faculty">Faculty</button>
            <button class="category-btn" data-category="phd">PhD Students</button>
            <button class="category-btn" data-category="masters">Master's Students</button>
            <button class="category-btn" data-category="undergraduate">Undergraduate Students</button>
            <button class="category-btn" data-category="staff">Research Staff</button>
            <button class="category-btn" data-category="alumni">Alumni</button>
        </div>

        <div id="team-container" class="team-container">
            <div id="team-loading" class="loading">Loading team members...</div>
        </div>
        
        <div id="team-error" class="error-message" style="display: none;"></div>

        <div class="join-cta">
            <h3>Interested in joining our team?</h3>
            <p>We're always looking for passionate researchers at all levels. Check out our <a href="contact.html">Contact</a> page.</p>
        </div>
    </main>
    
    <footer>
        <div class="footer-container">
            <div class="copyright">
                <p>Â© 2025 Murali Lab | IIT Jodhpur</p>
            </div>
        </div>
    </footer>

    <script>
        // ==========================================
        // TEAM LOADING & DISPLAY LOGIC
        // ==========================================
        async function loadTeam() {
            const teamContainer = document.getElementById('team-container');
            const loadingElement = document.getElementById('team-loading');
            const errorElement = document.getElementById('team-error');

            try {
                const response = await fetch('./team.json');
                if (!response.ok) throw new Error('Failed to load team data');
                const data = await response.json();
                displayTeam(data.team);
                loadingElement.style.display = 'none';
            } catch (error) {
                console.error(error);
                loadingElement.style.display = 'none';
                errorElement.style.display = 'block';
                errorElement.innerHTML = `<p>Unable to load team members. Ensure <strong>team.json</strong> is in the same folder.</p>`;
            }
        }

        function displayTeam(members) {
            const teamContainer = document.getElementById('team-container');
            
            teamContainer.innerHTML = members.map(member => {
                
                // 1. Generate Social Icons (returns string of <a> tags)
                const socialLinksHTML = generateSocialLinks(member.links);
                
                // 2. Generate Email Icon (returns string of <a> tag)
                // Note: We use fa-regular fa-envelope or fa-solid fa-envelope based on preference
                const emailLink = member.email 
                    ? `<a href="mailto:${convertEmailFormat(member.email)}" title="Email"><i class="fa-regular fa-envelope"></i></a>` 
                    : '';

                return `
                    <div class="team-member" data-category="${member.category}">
                        <div class="member-photo">
                            <img src="${member.photo}" alt="${member.name}" onerror="this.src='https://via.placeholder.com/200'">
                        </div>
                        <div class="member-info">
                            <h3 class="member-name">${member.name}</h3>
                            <div class="member-position">${member.position}</div>
                            <div class="member-bio">
                                <p>${member.bio}</p>
                            </div>
                            <div class="member-interests">
                                ${member.interests.map(interest => `<span class="interest-tag">${interest}</span>`).join('')}
                            </div>
                            
                            <div class="member-social-row">
                                ${emailLink}
                                ${socialLinksHTML}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            // Initialize "Read More" functionality for long bios
            initReadMore();
        }

        function generateSocialLinks(links) {
            if (!links || Object.keys(links).length === 0) return '';
            
            const iconMap = {
                'linkedin': 'fab fa-linkedin',
                'scholar': 'fas fa-graduation-cap',
                'orcid': 'fab fa-orcid',
                'github': 'fab fa-github',
                'twitter': 'fab fa-twitter',
                'website': 'fas fa-globe'
            };
            
            let linksHTML = '';
            
            // Loop through links and create <a> tags without wrapper divs
            Object.entries(links).forEach(([platform, url]) => {
                if (url && iconMap[platform]) {
                    linksHTML += `<a href="${url}" target="_blank" rel="noopener" title="${platform}"><i class="${iconMap[platform]}"></i></a>`;
                }
            });
            
            return linksHTML;
        }

        function convertEmailFormat(email) {
            // Converts "name[at]iitj[dot]ac[dot]in" to real email
            return email ? email.replace(/\[at\]/g, '@').replace(/\[dot\]/g, '.') : '';
        }

        function setupCategoryFilter() {
            document.querySelectorAll('.category-btn').forEach(button => {
                button.addEventListener('click', () => {
                    document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    const category = button.dataset.category;
                    document.querySelectorAll('.team-member').forEach(member => {
                        member.style.display = (category === 'all' || member.dataset.category === category) ? 'flex' : 'none';
                    });
                });
            });
        }

        function initReadMore() {
            document.querySelectorAll('.member-bio').forEach(bio => {
                const bioText = bio.querySelector('p');
                // Check if text is actually long enough to need collapsing (approx 200 chars)
                if (bioText.textContent.length > 200) {
                    bioText.classList.add('collapsed');
                    bio.insertAdjacentHTML('beforeend', '<button class="read-more-btn">Read more</button>');
                }
            });
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            loadTeam();
            setupCategoryFilter();
        });

        // Event delegation for dynamically added "Read More" buttons
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('read-more-btn')) {
                const bioContainer = e.target.closest('.member-bio');
                const bioText = bioContainer.querySelector('p');
                
                bioText.classList.toggle('collapsed');
                
                if (bioText.classList.contains('collapsed')) {
                    e.target.textContent = 'Read more';
                } else {
                    e.target.textContent = 'Read less';
                }
            }
        });
        // ==========================================
// MOBILE MENU TOGGLE LOGIC
// ==========================================
document.addEventListener('DOMContentLoaded', () => {
    const menuToggle = document.getElementById('mobile-menu');
    const nav = document.querySelector('nav');

    if (menuToggle && nav) {
        menuToggle.addEventListener('click', () => {
            nav.classList.toggle('active');
            
            // Optional: Change icon from Bars to X
            const icon = menuToggle.querySelector('i');
            if (nav.classList.contains('active')) {
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-times');
            } else {
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            }
        });
    }
});

    </script>
</body>
</html>